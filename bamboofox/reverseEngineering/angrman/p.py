from itertools import combinations_with_replacement
from pwn import *
from itertools import permutations

init_str = "3 EXIT GAME"
died = b"\nYou died\n"

iterable = ["1", "2", "3", "4", "5", "6", "7", "8", "9", "0"]
#iterable = ["1", "2", "3"]
r = 5

combi = list(combinations_with_replacement(iterable, r))
#print(combi)
#print("Total combinations:", len(combi))

permu = []

#info(type(combinations))
for i in range(len(combi)):
	comb = list(combi[i])
	tmp_permu = list(permutations(comb, r))
	permu += list(set(tmp_permu))
	#print(permu)

#info(permu)

for i in range(len(permu)):
	tmp = "".join(permu[i]) + "0" * 10
	p = process("./angrman")
	p.sendlineafter(init_str, b"2")
	p.sendline(tmp.encode())
	rec = p.recvall()
	if rec == died:
		info(tmp)
		info(rec)
	else:
		info("***************************************************************************************************************************************************")	
		info("***************************************************************************************************************************************************")	
		info("***************************************************************************************************************************************************")	
		info("***************************************************************************************************************************************************")	
		info("***************************************************************************************************************************************************")	
		info(tmp)
		info(rec)
		info("***************************************************************************************************************************************************")	
		info("***************************************************************************************************************************************************")	
		info("***************************************************************************************************************************************************")	
		info("***************************************************************************************************************************************************")	
		info("***************************************************************************************************************************************************")	
		info("***************************************************************************************************************************************************")	
		break
#print("Total permutations:", len(permutations))

